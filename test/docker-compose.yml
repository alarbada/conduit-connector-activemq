version: '3.8'

services:
  activemq:
    image: apache/activemq-classic
    container_name: activemq-classic
    ports:
      - "61613:61613" # STOMP
    environment:
      ACTIVEMQ_CONNECTION_USER: "connadmin"
      ACTIVEMQ_CONNECTION_PASSWORD: "connadmin"

  # for development: starts fast, stops faster
  activemq-dev:
    stop_grace_period: 100ms
    image: apache/activemq-classic
    container_name: activemq-classic
    ports:
      - "61613:61613" # STOMP
    environment:
      ACTIVEMQ_CONNECTION_USER: "admin"
      ACTIVEMQ_CONNECTION_PASSWORD: "admin"
    healthcheck:
      test: ["CMD", "curl", "http://localhost:8161"]
      interval: 100ms
      timeout: 20s
      retries: 100
      start_period: 100ms
